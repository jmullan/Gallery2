<?php

class DeleteAllItemsTestCase extends TestCase {

    var $_id = 1;

    function getDescription() {
	return "Delete all items in the database, one by one";
    }

    function testStart() {
	global $gallery;

	$ret = $gallery->lockWorld();
	if ($ret->isError()) {
	    return $ret;
	}
	    
	/*
	 * Since objects depend on each other, we need to search, delete one
	 * object, then search again.  Not very efficient.
	 */
	while (true) {
	    list ($ret, $results) =
		    $gallery->search(array(), array('GalleryNucleus::id'));
	    if ($ret->isError()) {
		return $ret;
	    }

	    if (sizeof($results) == 0) {
		break;
	    }
	    
	    $id = $results[0]['GalleryNucleus::id'];
	    $id = 4;
	    print "<H2> Delete Item $id </H2>\n";
	    $ret = $gallery->deleteNucleusById($id);
	    if ($ret->isError()) {
		return $ret;
	    }
	}

	$ret = $gallery->unlock();
	if ($ret->isError()) {
	    return $ret;
	}

	return GalleryStatus::success();
    }
}

?>
</pre>
