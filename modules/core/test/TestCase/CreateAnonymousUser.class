<?php

class CreateAnonymousUserTestCase extends TestCase {

    function getDescription() {
	return "Create the Anonymous user";
    }

    function testStart() {
	global $gallery;

	list ($ret, $user) = $gallery->newEntity('GalleryUser');
	if ($ret->isError()) {
	    return $ret->wrap(__FILE__, __LINE__);
	}

	$ret = $user->create('anonymous');
	if ($ret->isError()) {
	    return $ret->wrap(__FILE__, __LINE__);
	}
	$user->setFullName('Anonymous');
	$user->setLanguage('es_ES');
	
	$ret = $user->save();
	if ($ret->isError()) {
	    return $ret->wrap(__FILE__, __LINE__);
	}

	$ret = $gallery->setModuleParameter('core', 'id.anonymousUser',
					    $user->getId());
	if ($ret->isError()) {
	    return $ret->wrap(__FILE__, __LINE__);
	}

	return GalleryStatus::success();
    }
}

?>

